# Project Context: order-analysis

本文件定义了 `order_analysis` 项目的业务逻辑、技术架构与标准作业程序 (SOP)。

## 1. 项目定位
本工具用于分析订单交易流水数据，提供销售趋势、客单价分析、商品销售结构等维度的量化评估。
(Initial focus: Analyzing `K5.交易流水明细表`)

## 2. 核心架构
遵循全局“核壳分离”原则：
- **DataLoader (DAL)**: 负责读取 Excel/CSV 交易流水数据，进行清洗和标准化。
- **Core Analysis**:
    - **Metric Engine**: 基础指标计算（GMV, 订单数, 客单价等）。
    - **Trend Analyzer**: 时间序列趋势分析。
- **Reporting**: 生成结构化报告。

## 3. 标准作业程序 (SOP)
1. **数据清洗**: 必须强制剔除非实物商品项（如送货费、打包费、上门取货费）。
2. **价格审计**: 在进行任何弹性分析前，**必须基于 `折扣类型` 字段执行价格稳定性审计**，严禁将订单级满减券分摊后的价格视为商品的真实变价。
3. **五力诊断模型**: 每一份分析报告必须涵盖以下五个垂直视角：
    - **商品战略人格**: 渗透-带动四象限分析。
    - **价格引力诊断**: AOV 偏态分析与基于清洁基准期的折扣弹性。
    - **篮筐品质指纹**: 复杂度聚类与孤儿单归因。
    - **时空生活嵌入**: TGI 时段热力与周末异动。
    - **渠道效率矩阵**: 全渠道横向 Benchmark 排名。
4. **报告生成**: 遵循先数据事实、后指标定义、再客观解读的 DeepSearch 严谨标准。

## 4. 运行指令
(待定义，建议: `python -m order_analysis.run`)

## 5. 数据契约
所有输出报告必须为标准 JSON 或易读的 Excel/Markdown 格式。
数值保留 2-4 位小数。

## 6. 认知持久化 (Persistence of Cognition)
项目任务、决策过程与长期记忆存储于以下位置：
- `.gemini/tasks/current_task.md`: 当前活跃任务与子进度。
- `.gemini/tasks/memory.md`: 项目级长期记忆（业务洞察、价格稳定性审计规则等）。
- `.gemini/tasks/walkthrough.md`: 关键决策记录。
