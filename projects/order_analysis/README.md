# Order Analysis: 前置仓全链路经营诊断与情报挖掘系统

这是一个深度解构“消费者生活数字切片”的专业零售分析工程。它不只是简单的报表生成，而是一套将**数据科学家**的统计严谨性与**经营圣手**的战略直觉工程化的决策支持系统。

## 1. 核心元能力：从“行数据”到“商业事实”

本工程的核心元能力在于其**统计自适应 (Statistical Adaptation)** 机制。系统拒绝任何基于主观猜测的硬编码阈值（如“AOV大于50即为高”），而是通过扫描大盘分布，利用**四分位数 (Quantiles)** 和 **标准分 (Z-Score)** 动态定义指标的“高、低、强、弱”。这意味着系统可以无缝迁移至任何不同客单、不同品类、不同城市的零售数据集，实现自动化的自我校准。

## 2. 固化的分析流 (Analysis Flow)

工程将零散的探索过程固化为四个垂直深挖的计算阶段，每一步都直接指向特定的经营情报。

### 阶段一：还原真相 (Truth Recovery & Cleaning)
*   **计算任务**：
    *   **履约噪音剔除**：识别并过滤销售数量异常的非实物项（如送货费、打包费）。
    *   **价格真实性审计**：基于 `折扣类型` 字段穿透满减券干扰，区分“主动促销”与“被动分摊”。
*   **情报产出**：
    *   **破解“满减幻觉”**：揭示渠道中真实变价商品的占比（例如：万家App中 68% 的商品实际上处于价格僵死状态）。
    *   **指标脱水**：产出真实的 GMV、AOV 和 UPT（客件数）。

### 2. 战略定位 (Strategic Positioning)
*   **计算任务**：
    *   **Z-Score 效率矩阵**：计算各渠道相对于全网均值的 GMV 贡献、客单、客件及折扣偏差。
    *   **生态位判定**：自动为渠道贴标（如“高频低价强促销型”）。
*   **情报产出**：
    *   **渠道角色定义**：识别各渠道的战略职能（如 App 负责保基本盘，外卖抓中产即时需求）。

### 3. 五力深度诊断 (The 5-Force Diagnostic)
*   **商品力 (Product Persona)**：
    *   *指标*：渗透率 x 带动系数矩阵。
    *   *情报*：锁定 **Hooks (钩子)**、**Bundlers (潜力款)** 和 **Assassins (履约刺客)**。
*   **价格力 (Pricing Efficiency)**：
    *   *指标*：AOV 偏态系数 (Skewness) 与清洁基准期折扣弹性。
    *   *情报*：诊断客单价是否被大量低价值单“拖累”，评估促销资源是否在向“不打折也能卖”的商品流失。
*   **篮筐力 (Basket Fingerprint)**：
    *   *指标*：3D 复杂度聚类与孤儿单归因。
    *   *情报*：还原“囤货”与“补缺”客群结构，找出导致运费亏损的元凶 SKU。
*   **时空力 (Spatio-Temporal TGI)**：
    *   *指标*：TGI 时段热力模型（TGI > 120）。
    *   *情报*：识别不同时段（如早市、深夜）的心智统治级单品。

### 4. 认知表达 (Cognitive Reporting)
*   **工程模式**：**计算层 (JSON) 与 表达层 (Narrative) 解耦**。
*   **情报产出**：将 1.5MB 的结构化事实数据，由分析师（LLM）转化为具备“数据事实 -> 指标定义 -> 客观解读”结构的权威诊断书。

## 3. 核心商业发现示例 (Business Intelligence)

通过本工程的运行，我们获得了如下高价值情报：
1.  **促销负效率**：万家App 虽拥有 93% 的折扣渗透，但促销对客单的提升 (Uplift) 呈现负值，说明促销在补贴低价值订单。
2.  **聚餐场景爆发**：京东小时购在“周末晚市”切片中，Top 商品由“奶粉”瞬间切换为“啤酒+鱼”，揭示了强烈的即时聚餐场景。
3.  **刺客清单**：精准锁定了葱、蒜、单包纸巾等导致大量“孤儿单”和配送亏损的商品名单。

## 4. 运行指引

```bash
# 执行计算 Pipeline：产出 Analysis Cube (JSON)
PYTHONPATH=. ./.venv/bin/python order_analysis/src/strategic_pipeline.py

# 执行报告生成：产出 Strategic Reports (HTML/MD)
PYTHONPATH=. ./.venv/bin/python order_analysis/src/generators/strategic_reporter.py
```

---
> “分析的目的不是产生数字，而是产生改变现状的决策勇气。”